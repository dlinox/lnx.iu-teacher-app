import{h as K,d as _,F as Q,a$ as f,a,w as t,l as T,n as r,r as X,V as C,i as P,ak as v,b3 as V,b4 as g,ah as d,b5 as E,j as u,ac as I,b1 as w,c as H,z as Y,k as R,b6 as Z,o as i}from"./index-B4Q8W2lJ.js";import{b as h,c as j,d as ll,e as el}from"./index-BVECOarq.js";import{V as al,a as z,b as tl,c as O}from"./VTabs-CI0ZBrW6.js";import{V as F,a as N,b as ul}from"./VRow-D1cBycFV.js";const dl={class:"roudend-0 bg-primary"},nl={key:0},rl={key:1},ol={class:"border-s"},vl=K({__name:"GroupView",setup(sl){const A=Z(),x=_(!1),c=_("list"),n=_(null),M=_([]),G=_([]),$=_([]),S=_(!1),W=()=>{var o;for(let l=1;l<=((o=n==null?void 0:n.value)==null?void 0:o.units);l++)$.value.push({title:n.value.curriculumId===1&&l==1?"Capacidades":n.value.curriculumId===1&&l==2?"Actitudes":`Unidad ${l}`,value:l}),console.log($.value)},L=o=>{let l=G.value[o];if(n.value.curriculumId==1){let y=l.gradeUnits.filter(s=>s.order!==2),b=y.reduce((s,k)=>s+(parseFloat(k.grade)||0),0),U=y.length>0?b/y.length:0,e=l.gradeUnits.find(s=>s.order===2),m=e&&parseFloat(e.grade.toString())||0;l.finalGrade=parseFloat((U*.9+m).toFixed(2))}else if(n.value.curriculumId==2){let y=l.gradeUnits.reduce((U,e)=>U+(parseFloat(e.grade)||0),0),b=l.gradeUnits.length;l.finalGrade=b>0?parseFloat((y/b).toFixed(2)):0}},q=()=>(console.log(G.value),G.value.map(o=>({enrollmentGroupId:o.id,studentId:o.studentId,gradeId:o.gradeId,finalGrade:o.finalGrade,gradeUnits:o.gradeUnits.map(l=>({id:l.id,grade:l.grade,order:l.order}))}))),J=async()=>{const o=A.params.id;S.value=!0;const l=q();await h({grades:l}),G.value=await j(o),S.value=!1},B=async()=>{x.value=!0;const o=A.params.id;n.value=await ll(o),M.value=await el(o),G.value=await j(o),W(),x.value=!1};return Q(()=>{B()}),(o,l)=>{var b,U;const y=X("LnxIcon");return i(),f(I,null,[a(C,{title:`${(b=n.value)==null?void 0:b.name} | ${(U=n.value)==null?void 0:U.course}`,subtitle:"Estudiantes matriculados",class:"rounded-0"},{append:t(()=>[a(T,{variant:"text",onClick:l[0]||(l[0]=e=>o.$router.go(-1))},{prepend:t(()=>[a(y,{iconName:"arrow-left-3",size:"large"})]),default:t(()=>[l[3]||(l[3]=r(" Atrás "))]),_:1})]),_:1},8,["title"]),a(ul,null,{default:t(()=>[a(C,{class:"border",rounded:"0"},{default:t(()=>[a(al,{modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=e=>c.value=e)},{default:t(()=>[a(z,{value:"list"},{default:t(()=>l[4]||(l[4]=[r(" Lista de estudiantes ")])),_:1}),a(z,{value:"grade"},{default:t(()=>l[5]||(l[5]=[r(" Calificaciones ")])),_:1})]),_:1},8,["modelValue"]),a(P,null,{default:t(()=>[a(F,null,{default:t(()=>[a(N,null,{default:t(()=>[a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[6]||(l[6]=[r("Plan")])),_:1}),a(g,null,{default:t(()=>{var e;return[r(d((e=n.value)==null?void 0:e.curriculum),1)]}),_:1})]),_:1}),a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[7]||(l[7]=[r("Curso")])),_:1}),a(g,null,{default:t(()=>{var e;return[r(d((e=n.value)==null?void 0:e.course),1)]}),_:1})]),_:1}),a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[8]||(l[8]=[r("Modulo")])),_:1}),a(g,null,{default:t(()=>{var e;return[r(d((e=n.value)==null?void 0:e.module),1)]}),_:1})]),_:1}),a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[9]||(l[9]=[r("Área")])),_:1}),a(g,null,{default:t(()=>{var e;return[r(d((e=n.value)==null?void 0:e.area),1)]}),_:1})]),_:1})]),_:1}),a(N,null,{default:t(()=>[a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[10]||(l[10]=[r("Grupo")])),_:1}),a(g,null,{default:t(()=>{var e;return[r(d((e=n.value)==null?void 0:e.name),1)]}),_:1})]),_:1}),a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[11]||(l[11]=[r("Periodo")])),_:1}),a(g,null,{default:t(()=>{var e,m;return[r(d((e=n.value)==null?void 0:e.period)+" - "+d((m=n.value)==null?void 0:m.month),1)]}),_:1})]),_:1}),a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[12]||(l[12]=[r("Modalidad")])),_:1}),a(g,null,{default:t(()=>{var e;return[r(d((e=n.value)==null?void 0:e.modality),1)]}),_:1})]),_:1}),a(v,null,{default:t(()=>[a(V,null,{default:t(()=>l[13]||(l[13]=[r("Horario")])),_:1}),a(g,null,{default:t(()=>{var e,m,s,k,p,D;return[r(d((m=(e=n.value)==null?void 0:e.schedules)==null?void 0:m.days)+" "+d((k=(s=n.value)==null?void 0:s.schedules)==null?void 0:k.startHour)+" - "+d((D=(p=n.value)==null?void 0:p.schedules)==null?void 0:D.endHour),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(tl,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value=e)},{default:t(()=>[a(O,{value:"list"},{default:t(()=>[a(C,{class:"rounded-0"},{default:t(()=>[a(F,null,{default:t(()=>[a(N,{cols:"12"},{default:t(()=>[a(E,{class:"roudend-0"},{default:t(()=>[l[14]||(l[14]=u("thead",{class:"roudend-0 bg-primary"},[u("tr",null,[u("th",null,"N°"),u("th",null,"DNI"),u("th",null,"Nombre"),u("th",null,"Apellido Paterno"),u("th",null,"Apellido Materno"),u("th",null,"Email"),u("th",null,"Teléfono"),u("th",null,"Tipo de estudiante")])],-1)),u("tbody",null,[(i(!0),f(I,null,w(M.value,(e,m)=>(i(),f("tr",{key:e.id},[u("td",null,d(m+1),1),u("td",null,d(e.documentNumber),1),u("td",null,d(e.name),1),u("td",null,d(e.lastNameFather),1),u("td",null,d(e.lastNameMother),1),u("td",null,d(e.email),1),u("td",null,d(e.phone),1),u("td",null,d(e.studentType),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(O,{value:"grade"},{default:t(()=>[a(C,{class:"rounded-0"},{default:t(()=>[a(P,{class:"bg-grey-lighten-4 border"},{default:t(()=>[a(F,{justify:"end",align:"center"},{default:t(()=>[a(N,{cols:"12",class:"text-end"},{default:t(()=>[a(T,{color:"primary",onClick:B,variant:"tonal"},{default:t(()=>l[15]||(l[15]=[r(" Generar acta ")])),_:1}),a(T,{color:"primary",onClick:J,class:"ms-2",loadingSave:S.value},{default:t(()=>l[16]||(l[16]=[r(" Guardar ")])),_:1},8,["loadingSave"])]),_:1})]),_:1})]),_:1}),a(F,null,{default:t(()=>[a(N,{cols:"12"},{default:t(()=>[a(E,{class:"roudend-0"},{default:t(()=>[u("thead",dl,[u("tr",null,[l[17]||(l[17]=u("th",null,"N°",-1)),l[18]||(l[18]=u("th",null,"DNI",-1)),l[19]||(l[19]=u("th",null,"Nombre",-1)),l[20]||(l[20]=u("th",null,"Apellido Paterno",-1)),l[21]||(l[21]=u("th",null,"Apellido Materno",-1)),(i(!0),f(I,null,w(n.value.units,e=>(i(),f("th",{style:{width:"150px"},key:e},[n.value.curriculumId==1?(i(),f("span",nl,[e==1?(i(),f(I,{key:0},[r(" Prom. Cap. ")],64)):(i(),f(I,{key:1},[r(" Act ")],64))])):(i(),f("span",rl," UNIDAD "+d(e),1))]))),128)),l[22]||(l[22]=u("th",{style:{width:"150px"}},"Nota final",-1))])]),u("tbody",null,[(i(!0),f(I,null,w(G.value,(e,m)=>(i(),f("tr",{key:e.id},[u("td",null,d(m+1),1),u("td",null,d(e.documentNumber),1),u("td",null,d(e.name),1),u("td",null,d(e.lastNameFather),1),u("td",null,d(e.lastNameMother),1),(i(!0),f(I,null,w(e.gradeUnits,(s,k)=>(i(),f("td",{key:k,class:"border-s"},[n.value.curriculumId==1&&s.order==2?(i(),H(Y,{key:0,modelValue:s.grade,"onUpdate:modelValue":[p=>s.grade=p,p=>L(m)],density:"compact",items:[{title:"A",value:"2.00"},{title:"B",value:"1.00"},{title:"C",value:"0.00"}]},null,8,["modelValue","onUpdate:modelValue"])):(i(),H(R,{key:1,modelValue:s.grade,"onUpdate:modelValue":[p=>s.grade=p,p=>L(m)],modelModifiers:{number:!0},type:"number",min:"0",max:"20",density:"compact"},null,8,["modelValue","onUpdate:modelValue"]))]))),128)),u("td",ol,[a(R,{type:"number",modelValue:e.finalGrade,"onUpdate:modelValue":s=>e.finalGrade=s,modelModifiers:{number:!0},density:"compact",readonly:""},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}});export{vl as default};
