import{h as z,d as G,F as W,a_ as m,a as e,w as t,l as j,n as o,r as B,V as I,i as H,ak as p,b2 as V,b3 as v,ah as n,ac as y,b0 as w,c as U,aX as O,b4 as M,j as u,b5 as X,b6 as J,x as K,z as Q,k as D,b7 as Y,o as i}from"./index-DsGDyTjR.js";import{a as Z,b as h,c as ll,d as el}from"./index-DzuRAgcC.js";import{V as al,a as $,b as tl,c as q}from"./VTabs-B7ffHdSI.js";import{V as F,a as x,b as ul}from"./VRow-DJcp50Gg.js";const nl={class:"roudend-0 bg-grey"},dl={class:"border-s"},pl=z({__name:"GroupView",setup(ol){const P=Y(),T=G(!1),c=G("list"),r=G(null),S=G([]),k=G([]),L=s=>{let a=k.value[s];if(r.value.curriculumId==1){let g=a.gradeUnits.filter(d=>d.order!==2),N=g.reduce((d,f)=>d+(parseFloat(f.grade)||0),0),b=g.length>0?N/g.length:0,_=a.gradeUnits.find(d=>d.order===2),l=_&&parseFloat(_.grade.toString())||0;a.finalGrade=parseFloat((b*.9+l).toFixed(2))}else if(r.value.curriculumId==2){let g=a.gradeUnits.reduce((b,_)=>b+(parseFloat(_.grade)||0),0),N=a.gradeUnits.length;a.finalGrade=N>0?parseFloat((g/N).toFixed(2)):0}},R=()=>k.value.map(s=>({studentId:s.id,enrollmentGroupId:s.enrollmentGroupId,finalGrade:s.finalGrade})),rl=async()=>{const s=R();await el({grades:s}),await A(),console.log(s)},A=async()=>{T.value=!0;const s=P.params.id;r.value=await Z(s),S.value=await h(s),k.value=await ll(s),T.value=!1};return W(()=>{A()}),(s,a)=>{var b,_;const g=B("LnxIcon"),N=B("LnxDialogConfirm");return i(),m(y,null,[e(I,{title:`${(b=r.value)==null?void 0:b.name} | ${(_=r.value)==null?void 0:_.course}`,subtitle:"Estudiantes matriculados",class:"rounded-0"},{append:t(()=>[e(j,{variant:"text",onClick:a[0]||(a[0]=l=>s.$router.go(-1))},{prepend:t(()=>[e(g,{iconName:"arrow-left-3",size:"large"})]),default:t(()=>[a[4]||(a[4]=o(" Atrás "))]),_:1})]),_:1},8,["title"]),e(ul,null,{default:t(()=>[e(I,{class:"border",rounded:"0"},{default:t(()=>[e(al,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=l=>c.value=l)},{default:t(()=>[e($,{value:"list"},{default:t(()=>a[5]||(a[5]=[o(" Lista de estudiantes ")])),_:1}),e($,{value:"grade"},{default:t(()=>a[6]||(a[6]=[o(" Notas ")])),_:1})]),_:1},8,["modelValue"]),e(H,null,{default:t(()=>[e(F,null,{default:t(()=>[e(x,null,{default:t(()=>[e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[7]||(a[7]=[o("Plan")])),_:1}),e(v,null,{default:t(()=>{var l;return[o(n((l=r.value)==null?void 0:l.curriculum),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[8]||(a[8]=[o("Curso")])),_:1}),e(v,null,{default:t(()=>{var l;return[o(n((l=r.value)==null?void 0:l.course),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[9]||(a[9]=[o("Modulo")])),_:1}),e(v,null,{default:t(()=>{var l;return[o(n((l=r.value)==null?void 0:l.module),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[10]||(a[10]=[o("Área")])),_:1}),e(v,null,{default:t(()=>{var l;return[o(n((l=r.value)==null?void 0:l.area),1)]}),_:1})]),_:1})]),_:1}),e(x,null,{default:t(()=>[e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[11]||(a[11]=[o("Grupo")])),_:1}),e(v,null,{default:t(()=>{var l;return[o(n((l=r.value)==null?void 0:l.name),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[12]||(a[12]=[o("Periodo")])),_:1}),e(v,null,{default:t(()=>{var l,d;return[o(n((l=r.value)==null?void 0:l.period)+" - "+n((d=r.value)==null?void 0:d.month),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[13]||(a[13]=[o("Modalidad")])),_:1}),e(v,null,{default:t(()=>{var l;return[o(n((l=r.value)==null?void 0:l.modality),1)]}),_:1})]),_:1}),e(p,null,{default:t(()=>[e(V,null,{default:t(()=>a[14]||(a[14]=[o("Horario")])),_:1}),e(v,null,{default:t(()=>{var l;return[(i(!0),m(y,null,w((l=r.value)==null?void 0:l.schedules,d=>(i(),U(O,{key:d.id,color:"primary",rounded:"0",class:"me-2",label:""},{default:t(()=>[o(n(d.day)+" "+n(d.start_hour)+" - "+n(d.end_hour),1)]),_:2},1024))),128))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(tl,{modelValue:c.value,"onUpdate:modelValue":a[3]||(a[3]=l=>c.value=l)},{default:t(()=>[e(q,{value:"list"},{default:t(()=>[e(I,{class:"rounded-0"},{default:t(()=>[e(F,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(M,{class:"roudend-0"},{default:t(()=>[a[15]||(a[15]=u("thead",{class:"roudend-0 bg-grey"},[u("tr",null,[u("th",null,"N°"),u("th",null,"DNI"),u("th",null,"Nombre"),u("th",null,"Apellido Paterno"),u("th",null,"Apellido Materno"),u("th",null,"Email"),u("th",null,"Teléfono"),u("th",null,"Tipo de estudiante")])],-1)),u("tbody",null,[(i(!0),m(y,null,w(S.value,(l,d)=>(i(),m("tr",{key:l.id},[u("td",null,n(d+1),1),u("td",null,n(l.documentNumber),1),u("td",null,n(l.name),1),u("td",null,n(l.lastNameFather),1),u("td",null,n(l.lastNameMother),1),u("td",null,n(l.email),1),u("td",null,n(l.phone),1),u("td",null,n(l.studentType),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(q,{value:"grade"},{default:t(()=>[e(I,{class:"rounded-0"},{default:t(()=>[e(X,null,{default:t(()=>[e(K),J("",!0)]),_:1}),e(F,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(M,{class:"roudend-0"},{default:t(()=>[u("thead",nl,[u("tr",null,[a[17]||(a[17]=u("th",null,"N°",-1)),a[18]||(a[18]=u("th",null,"DNI",-1)),a[19]||(a[19]=u("th",null,"Nombre",-1)),a[20]||(a[20]=u("th",null,"Apellido Paterno",-1)),a[21]||(a[21]=u("th",null,"Apellido Materno",-1)),(i(!0),m(y,null,w(r.value.units,l=>(i(),m("th",{style:{width:"150px"},key:l}," UNIDAD: "+n(l),1))),128)),a[22]||(a[22]=u("th",{style:{width:"150px"}},"Nota final",-1))])]),u("tbody",null,[(i(!0),m(y,null,w(k.value,(l,d)=>(i(),m("tr",{key:l.id},[u("td",null,n(d+1),1),u("td",null,n(l.documentNumber),1),u("td",null,n(l.name),1),u("td",null,n(l.lastNameFather),1),u("td",null,n(l.lastNameMother),1),(i(!0),m(y,null,w(l.gradeUnits,(f,E)=>(i(),m("td",{key:E,class:"border-s"},[r.value.curriculumId==1&&f.order==2?(i(),U(Q,{key:0,modelValue:f.grade,"onUpdate:modelValue":[C=>f.grade=C,C=>L(d)],density:"compact",items:[{title:"A",value:"2.00"},{title:"B",value:"1.00"},{title:"C",value:"0.00"}]},null,8,["modelValue","onUpdate:modelValue"])):(i(),U(D,{key:1,modelValue:f.grade,"onUpdate:modelValue":[C=>f.grade=C,C=>L(d)],modelModifiers:{number:!0},type:"number",min:"0",max:"20",density:"compact"},null,8,["modelValue","onUpdate:modelValue"]))]))),128)),u("td",dl,[e(D,{type:"number",modelValue:l.finalGrade,"onUpdate:modelValue":f=>l.finalGrade=f,modelModifiers:{number:!0},density:"compact",readonly:""},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}});export{pl as default};
