import{h,d as _,F as z,a_ as b,a as l,w as a,l as L,n as o,r as M,V as c,i as W,ak as f,b2 as p,b3 as V,ah as d,ac as g,b0 as A,c as j,aX as H,b4 as U,j as u,b5 as O,x as X,k as B,z as J,b6 as K,o as v}from"./index-DOUGcZ8E.js";import{a as Q,b as Y,c as Z,d as ll}from"./index-C_i-M9AQ.js";import{V as el,a as $,b as al,c as D}from"./VTabs-f3o11M72.js";import{V as C,a as G,b as tl}from"./VRow-9J4XKeCF.js";const ul={class:"border-s"},dl={class:"border-s"},ml=h({__name:"GroupView",setup(nl){const P=K(),I=_(!1),y=_("list"),s=_(null),N=_([]),w=_([]),q=n=>{w.value=N.value.map(t=>{const r=n.find(x=>x.studentId===t.id);return{...t,capacityAverage:r!=null&&r.capacityAverage?Number(r.capacityAverage).toFixed(2):null,attitudeGrade:r==null?void 0:r.attitudeGrade,finalGrade:r!=null&&r.finalGrade?Number(r.finalGrade).toFixed(2):null}})},S=n=>{const t=Number(n.capacityAverage)||0,r=n.attitudeGrade==="A"?2:n.attitudeGrade==="B"?1:0;n.finalGrade=(.9*t+r).toFixed(2)},R=()=>w.value.map(n=>({studentId:n.id,enrollmentGroupId:n.enrollmentGroupId,capacityAverage:n.capacityAverage,attitudeGrade:n.attitudeGrade,finalGrade:n.finalGrade})),E=async()=>{const n=R();await Q({grades:n}),await T(),console.log(n)},T=async()=>{I.value=!0;const n=P.params.id;s.value=await Y(n),N.value=await Z(n);let t=await ll(n);q(t),I.value=!1};return z(()=>{T()}),(n,t)=>{var k,F;const r=M("LnxIcon"),x=M("LnxDialogConfirm");return v(),b(g,null,[l(c,{title:`${(k=s.value)==null?void 0:k.name} | ${(F=s.value)==null?void 0:F.course}`,subtitle:"Estudiantes matriculados",class:"rounded-0"},{append:a(()=>[l(L,{variant:"text",onClick:t[0]||(t[0]=e=>n.$router.go(-1))},{prepend:a(()=>[l(r,{iconName:"arrow-left-3",size:"large"})]),default:a(()=>[t[3]||(t[3]=o(" Atrás "))]),_:1})]),_:1},8,["title"]),l(tl,null,{default:a(()=>[l(c,{class:"border",rounded:"0"},{default:a(()=>[l(el,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e)},{default:a(()=>[l($,{value:"list"},{default:a(()=>t[4]||(t[4]=[o(" Lista de estudiantes ")])),_:1}),l($,{value:"grade"},{default:a(()=>t[5]||(t[5]=[o(" Notas ")])),_:1})]),_:1},8,["modelValue"]),l(W,null,{default:a(()=>[l(C,null,{default:a(()=>[l(G,null,{default:a(()=>[l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[6]||(t[6]=[o("Grupo")])),_:1}),l(V,null,{default:a(()=>{var e;return[o(d((e=s.value)==null?void 0:e.name),1)]}),_:1})]),_:1}),l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[7]||(t[7]=[o("Curso")])),_:1}),l(V,null,{default:a(()=>{var e;return[o(d((e=s.value)==null?void 0:e.course),1)]}),_:1})]),_:1}),l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[8]||(t[8]=[o("Modulo")])),_:1}),l(V,null,{default:a(()=>{var e;return[o(d((e=s.value)==null?void 0:e.module),1)]}),_:1})]),_:1}),l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[9]||(t[9]=[o("Área")])),_:1}),l(V,null,{default:a(()=>{var e;return[o(d((e=s.value)==null?void 0:e.area),1)]}),_:1})]),_:1})]),_:1}),l(G,null,{default:a(()=>[l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[10]||(t[10]=[o("Periodo")])),_:1}),l(V,null,{default:a(()=>{var e,i;return[o(d((e=s.value)==null?void 0:e.period)+" - "+d((i=s.value)==null?void 0:i.month),1)]}),_:1})]),_:1}),l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[11]||(t[11]=[o("Modalidad")])),_:1}),l(V,null,{default:a(()=>{var e;return[o(d((e=s.value)==null?void 0:e.modality),1)]}),_:1})]),_:1}),l(f,null,{default:a(()=>[l(p,null,{default:a(()=>t[12]||(t[12]=[o("Horario")])),_:1}),l(V,null,{default:a(()=>{var e;return[(v(!0),b(g,null,A((e=s.value)==null?void 0:e.schedules,i=>(v(),j(H,{key:i.id,color:"primary",rounded:"0",class:"me-2",label:""},{default:a(()=>[o(d(i.day)+" "+d(i.start_hour)+" - "+d(i.end_hour),1)]),_:2},1024))),128))]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(al,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=e=>y.value=e)},{default:a(()=>[l(D,{value:"list"},{default:a(()=>[l(c,{class:"rounded-0"},{default:a(()=>[l(C,null,{default:a(()=>[l(G,{cols:"12"},{default:a(()=>[l(U,{class:"roudend-0"},{default:a(()=>[t[13]||(t[13]=u("thead",{class:"roudend-0 bg-grey"},[u("tr",null,[u("th",null,"N°"),u("th",null,"DNI"),u("th",null,"Nombre"),u("th",null,"Apellido Paterno"),u("th",null,"Apellido Materno"),u("th",null,"Email"),u("th",null,"Teléfono"),u("th",null,"Tipo de estudiante")])],-1)),u("tbody",null,[(v(!0),b(g,null,A(N.value,(e,i)=>(v(),b("tr",{key:e.id},[u("td",null,d(i+1),1),u("td",null,d(e.documentNumber),1),u("td",null,d(e.name),1),u("td",null,d(e.lastNameFather),1),u("td",null,d(e.lastNameMother),1),u("td",null,d(e.email),1),u("td",null,d(e.phone),1),u("td",null,d(e.studentType),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(D,{value:"grade"},{default:a(()=>[l(c,{class:"rounded-0"},{default:a(()=>[l(O,null,{default:a(()=>[l(X),l(L,{color:"primary",variant:"flat"},{default:a(()=>[t[14]||(t[14]=o(" Registrar notas ")),l(x,{title:"Guardar notas",message:"¿Seguro que desea guardar las notas?,verifique que los datos sean correctos.",onOnConfirm:E})]),_:1})]),_:1}),l(C,null,{default:a(()=>[l(G,{cols:"12"},{default:a(()=>[l(U,{class:"roudend-0"},{default:a(()=>[t[15]||(t[15]=u("thead",{class:"roudend-0 bg-grey"},[u("tr",null,[u("th",null,"N°"),u("th",null,"DNI"),u("th",null,"Nombre"),u("th",null,"Apellido Paterno"),u("th",null,"Apellido Materno"),u("th",{style:{width:"120px"}},"Prom. Cap."),u("th",{style:{width:"120px"}},"Act."),u("th",{style:{width:"120px"}},"Nota final")])],-1)),u("tbody",null,[(v(!0),b(g,null,A(w.value,(e,i)=>(v(),b("tr",{key:e.id},[u("td",null,d(i+1),1),u("td",null,d(e.documentNumber),1),u("td",null,d(e.name),1),u("td",null,d(e.lastNameFather),1),u("td",null,d(e.lastNameMother),1),u("td",ul,[l(B,{type:"number",min:"0",max:"20",modelValue:e.capacityAverage,"onUpdate:modelValue":[m=>e.capacityAverage=m,m=>S(e)],modelModifiers:{number:!0},density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),u("td",null,[l(J,{modelValue:e.attitudeGrade,"onUpdate:modelValue":[m=>e.attitudeGrade=m,m=>S(e)],density:"compact",items:["A","B","C"]},null,8,["modelValue","onUpdate:modelValue"])]),u("td",dl,[l(B,{type:"number",modelValue:e.finalGrade,"onUpdate:modelValue":m=>e.finalGrade=m,modelModifiers:{number:!0},density:"compact",readonly:""},null,8,["modelValue","onUpdate:modelValue"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}});export{ml as default};
